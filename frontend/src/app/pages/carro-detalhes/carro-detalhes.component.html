<div class="car-details-container">
  <div class="main-content-wrapper">
    <div class="car-images-section">
      <div class="main-image">
        <img [src]="mainCarImage" [alt]="carro.marca + ' ' + carro.modelo" class="img-fluid">
        <span class="status-badge available" *ngIf="carro.disponivelParaAluguel">
          Dispon√≠vel
        </span>
      </div>
    </div>

    <div class="car-info-options-section">
      <div class="car-info-header">
        <h1>{{ carro.marca }} {{ carro.modelo }} {{ carro.ano }}</h1>
        <p class="car-subtitle">{{ getCategory() }} com {{ getPerformance() }} e tecnologia avan√ßada.</p>
      </div>

      <div class="car-pricing">
        <div class="pricing-option" *ngIf="carro.disponivelParaAluguel">
          <span>Aluguel</span>
          <p>R$ {{ carro.precoAluguelPorDia | number:'1.2-2' }}/dia</p>
        </div>
        <div class="pricing-option" *ngIf="carro.disponivelParaVenda">
          <span>Venda</span>
          <p>R$ {{ carro.precoVenda | number:'1.2-2' }}</p>
        </div>
      </div>

      <div class="car-specifications">
        <div class="spec-group">
          <div class="spec-item"><i class="fas fa-calendar-alt"></i> Ano: {{ carro.ano }}</div>
          <div class="spec-item"><i class="fas fa-palette"></i> Cor: {{ carro.cor }}</div>
        </div>
        <div class="spec-group">
          <div class="spec-item"><i class="fas fa-gas-pump"></i> {{ carro.tipoCombustivel }}</div>
          <div class="spec-item"><i class="fas fa-door-open"></i> {{ carro.portas }} Portas</div>
        </div>
        <div class="spec-group">
          <div class="spec-item"><i class="fas fa-tachometer-alt"></i> {{ getMileage() | number:'1.0-0' }} km</div>
          <div class="spec-item"><i class="fas fa-cogs"></i> {{ getTransmission() }}</div>
        </div>
        <div class="spec-group">
          <div class="spec-item"><i class="fas fa-id-card"></i> Placa: {{ carro.placa }}</div>
          <div class="spec-item"><i class="fas fa-snowflake"></i> Ar Condicionado</div>
        </div>
      </div>

      <div class="car-description">
        <h3>Descri√ß√£o</h3>
        <p>{{ getDescription() }}</p>
      </div>

      <div class="car-options-card">
        <div class="options-toggle">
          <button [class.active]="currentOption === 'aluguel'"
                  (click)="setCurrentOption('aluguel')" [disabled]="!carro.disponivelParaAluguel"
                  class="toggle-btn">
            Aluguel
          </button>
          <button [class.active]="currentOption === 'compra'"
                  (click)="setCurrentOption('compra')" [disabled]="!carro.disponivelParaVenda"
                  class="toggle-btn">
            Compra
          </button>
        </div>

        <ng-container *ngIf="currentOption === 'aluguel'">
          <h3>Op√ß√µes de Aluguel</h3>
          <div class="form-group">
            <label for="pickupDate">Data de Retirada</label>
            <div class="date-input-wrapper">
              <input type="date" id="pickupDate" [(ngModel)]="rentalDates.pickup" (change)="calculateTotalRental()">
              <i class="fas fa-calendar-alt date-icon"></i>
            </div>
          </div>

          <div class="form-group">
            <label for="returnDate">Data de Devolu√ß√£o</label>
            <div class="date-input-wrapper">
              <input type="date" id="returnDate" [(ngModel)]="rentalDates.return" (change)="calculateTotalRental()">
              <i class="fas fa-calendar-alt date-icon"></i>
            </div>
          </div>

          <div class="divider"></div>

          <div class="total-estimate">
            <span>Total Estimado ({{ rentalDays }} dias):</span>
            <span class="total-price">R$ {{ totalRentalPrice | number:'1.2-2' }}</span>
          </div>

          <button class="action-btn primary-btn" (click)="rentCar()">
            Alugar Este Carro
          </button>
        </ng-container>

        <ng-container *ngIf="currentOption === 'compra' && carro.disponivelParaVenda">
          <h3>Op√ß√µes de Compra</h3>

          <div class="opcoes-compra-lista">
            <div class="opcao-item">
              <i class="fas fa-check-circle"></i>
              <span>üí∞ Financiamento Dispon√≠vel</span>
            </div>
            <div class="opcao-item">
              <i class="fas fa-check-circle"></i>
              <span>üöó Agende um Test Drive</span>
            </div>
          </div>

          <p class="compra-descricao">
            Interessado em comprar este ve√≠culo? Entre em contato para mais informa√ß√µes e para agendar uma visita.
          </p>

          <button class="action-btn secondary-btn" (click)="buyCar()">
            Tenho Interesse
          </button>
        </ng-container>

        <!-- Mensagem se a op√ß√£o n√£o estiver dispon√≠vel -->
        <div *ngIf="(currentOption === 'aluguel' && !carro.disponivelParaAluguel) ||
                (currentOption === 'compra' && !carro.disponivelParaVenda)"
             class="unavailable-message">
          <p>Esta op√ß√£o n√£o est√° dispon√≠vel para este ve√≠culo no momento.</p>
        </div>
      </div>
    </div>
  </div>

  <div class="similar-cars-section" *ngIf="similarCars.length > 0">
    <h3>Carros Similares que Voc√™ Pode Gostar</h3>
    <div class="similar-cars-grid">
      <div class="similar-car-card" *ngFor="let similarCar of similarCars">
        <div class="similar-car-image">
          <img [src]="similarCar.urlImagem || 'assets/placeholder-carro.jpg'"
               [alt]="similarCar.marca + ' ' + similarCar.modelo"
               onerror="this.src='assets/placeholder-carro.jpg'">
        </div>

        <div class="similar-car-info">
          <h4>{{ similarCar.marca }} {{ similarCar.modelo }} {{ similarCar.ano }}</h4>
          <div class="similar-car-pricing">
            <p class="rental-price">
              R$ {{ similarCar.precoAluguelPorDia | number:'1.2-2' }}/dia
            </p>
          </div>
        </div>
        <div class="similar-car-actions">
          <a [routerLink]="['/carros', similarCar.id]"
             (click)="scrollToTop()"
             class="view-details-link"> Ver Detalhes </a>
        </div>
      </div>
    </div>
  </div>
</div>
